# ğŸ“„ Receipt2Sheets â€” AI-Powered Telegram Expense Tracker

Receipt2Sheets is a **Telegram bot** that automatically reads expense receipts (images or text), extracts structured data using **OCR + AI**, and appends the results into **Google Sheets**.

The application is deployed on **Render**, uses **OpenRouter** for AI parsing, and integrates with **Google Drive & Google Sheets** using OAuth credentials.

---

## ğŸ—ï¸ High-Level Architecture

![Receipt2Sheets Architecture](https://raw.githubusercontent.com/p-krishnaprasad/Image-host/refs/heads/main/Portfolio/Receipt2Sheets.png)

---

## ğŸš€ Features

- ğŸ“¸ Receipt image processing using OCR
- ğŸ“ Text-based expense parsing
- ğŸ¤– AI-powered semantic extraction via OpenRouter
- ğŸ“Š Automatic Google Sheets append
- ğŸ“ Files stored in a specific Google Drive folder
- âš¡ Fast Telegram response with background processing
- ğŸ” Duplicate Telegram update protection
- â˜ï¸ Cloud-native deployment on Render

---

## ğŸ§° Tech Stack

- **Python 3.11**
- **Flask**
- **Telegram Bot API**
- **Tesseract OCR**
- **OpenRouter (LLM API)**
- **Google Drive API**
- **Google Sheets API**
- **Gunicorn**
- **Docker**
- **Render**

---

## ğŸ”‘ Prerequisites

### 1ï¸âƒ£ Telegram Bot

- Create a bot via **@BotFather**
- Save the **BOT_TOKEN**

---

### 2ï¸âƒ£ OpenRouter (LLM Provider)

- Create an account at https://openrouter.ai
- Generate an API key
- Choose a supported model (example: `openai/gpt-4o-mini`)

---

### 3ï¸âƒ£ Google OAuth Credentials (Drive + Sheets)

This project uses **OAuth (Client ID + Refresh Token)** instead of a service account.

Steps:

1. Create a project in **Google Cloud Console**
2. Enable:
   - Google Drive API
   - Google Sheets API
3. Create **OAuth Client ID**
4. Generate:
   - Client ID
   - Client Secret
   - Refresh Token
5. Create a target folder in Google Drive and note its **Folder ID**

---

## âš™ï¸ Environment Variables (Render)

Set the following variables in **Render â†’ Service â†’ Environment**:

```env
BOT_TOKEN=your_telegram_bot_token

OPENROUTER_MODEL_NAME=openai/gpt-4o-mini
OPENROUTER_API_KEY=your_openrouter_api_key

GOOGLE_DRIVE_FOLDER_ID=your_drive_folder_id
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_REFRESH_TOKEN=your_google_refresh_token
âš ï¸ Do NOT commit secrets to GitHub.
All secrets should live in Render Environment Variables.
```

---

ğŸ§ª Local Development

1ï¸âƒ£ Clone repository
bash
Copy code
git clone https://github.com/yourusername/receipt2sheets.git
cd receipt2sheets
2ï¸âƒ£ Create virtual environment
bash
Copy code
python -m venv venv
source venv/bin/activate
3ï¸âƒ£ Install system dependencies (Linux / WSL)
bash
Copy code
sudo apt update
sudo apt install -y tesseract-ocr poppler-utils
4ï¸âƒ£ Install Python dependencies
bash
Copy code
pip install -r requirements.txt
â–¶ï¸ Run Locally
bash
Copy code
gunicorn -w 1 -b 0.0.0.0:5000 wsgi:app
â˜ï¸ Deployment on Render
1ï¸âƒ£ Create a new Web Service
Runtime: Docker

Region: Any

Branch: main

2ï¸âƒ£ Build Command
nginx
Copy code
docker build -t receipt2sheets .
3ï¸âƒ£ Start Command
nginx
Copy code
gunicorn -w 1 -b 0.0.0.0:5000 wsgi:app
ğŸ”— Telegram Webhook Setup
After Render deployment, set webhook:

bash
Copy code
curl -X POST \
https://api.telegram.org/bot<BOT_TOKEN>/setWebhook \
-d "url=https://your-render-app.onrender.com/telegram"
Verify webhook:

bash
Copy code
curl https://api.telegram.org/bot<BOT_TOKEN>/getWebhookInfo

---

ğŸ›¡ï¸ Reliability & Safety
Prevents duplicate Telegram update_id processing

Acknowledges Telegram quickly to avoid retries

Isolates OCR, AI, and Sheets logic into services

Timing and performance logging built-in

---

ğŸ“ˆ Future Improvements
Monthly expense summaries

Charts & dashboards

Multi-currency support

PDF receipt support

Google Drive receipt archiving

---

ğŸ§‘â€ğŸ’» Author
Krishna Prasad
Senior Software Engineer
AI Automation â€¢ Cloud â€¢ Backend Systems

---

ğŸ“œ License
MIT License

```

```
